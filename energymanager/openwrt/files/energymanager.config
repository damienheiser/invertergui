# Energy Manager configuration for OpenWRT
# Edit this file to configure your energy management system

config main 'main'
    option enabled '1'
    # Port 8081 to avoid conflict with GL.iNet admin panel on 8080
    option listen ':8081'
    # REQUIRED: Shelly Pro EM3 IP address and Modbus port
    option shelly_addr '192.168.1.100:502'
    option shelly_interval '1s'

config victron 'victron'
    option enabled '1'
    option port '/dev/ttyUSB0'
    # Maximum charge/discharge power in watts
    option maxpower '5000'

config pid 'pid'
    option enabled '1'
    # PID gains - tune these for your system
    option kp '0.8'
    option ki '0.05'
    option kd '0.1'
    # Target grid power (0 = zero export/import)
    option setpoint '0'

config mqtt 'mqtt'
    option enabled '0'
    option broker 'tcp://localhost:1883'
    option topic 'energy/status'
    option clientid 'energymanager'
    option username ''
    option password ''
